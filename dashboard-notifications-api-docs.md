# ğŸ“¬ ØªÙˆØ«ÙŠÙ‚ API Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…

> Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…ÙˆØ¬Ù‡ Ù„Ù…Ø·ÙˆØ± Ø§Ù„Ù€ Dashboard Ù„ØªÙ†ÙÙŠØ° Ù†Ø¸Ø§Ù… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª

---

## ğŸ” Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

- **Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©**: Bearer Token (Admin ÙÙ‚Ø·)
- **Base URL**: `{BASE_URL}/api`
- **Content-Type**: `application/json`

---

## 1ï¸âƒ£ Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†

### `GET /api/admin/users-summary`

ÙŠØ³ØªØ®Ø¯Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ø®ØªÙŠØ§Ø±Ù‡Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª.

### Query Parameters

| Parameter | Type | Required | Default | Description |
|-----------|------|----------|---------|-------------|
| `per_page` | integer | Ù„Ø§ | 20 | Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ Ø§Ù„ØµÙØ­Ø© |
| `page` | integer | Ù„Ø§ | 1 | Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø© |
| `role` | string | Ù„Ø§ | - | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±: `admin`, `user`, `reviewer`, `advertiser` |
| `status` | string | Ù„Ø§ | - | ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©: `active`, `blocked` |
| `q` | string | Ù„Ø§ | - | Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø£Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… |

### Ù…Ø«Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨

```http
GET /api/admin/users-summary?per_page=50&status=active&q=Ø£Ø­Ù…Ø¯
Authorization: Bearer {TOKEN}
```

### Ù…Ø«Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©

```json
{
  "meta": {
    "page": 1,
    "per_page": 50,
    "total": 125,
    "last_page": 3
  },
  "users": [
    {
      "id": 1,
      "name": "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",
      "phone": "01012345678",
      "user_code": "USR001",
      "status": "active",
      "registered_at": "2025-01-15",
      "listings_count": 5,
      "role": "user"
    }
  ]
}
```

---

## 2ï¸âƒ£ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±

### `POST /api/notifications`

> âš ï¸ **ÙŠØªØ·Ù„Ø¨ ØµÙ„Ø§Ø­ÙŠØ© Admin**

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `title` | string | âœ… Ù†Ø¹Ù… | Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (max: 255 Ø­Ø±Ù) |
| `body` | string | âœ… Ù†Ø¹Ù… | Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± |
| `user_id` | integer | âœ… Ù†Ø¹Ù… | Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù |
| `type` | string | Ù„Ø§ | Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± (Ù„Ù„ØªØµÙ†ÙŠÙ) |
| `data` | object | Ù„Ø§ | Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© JSON |

### Ù…Ø«Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨

```http
POST /api/notifications
Authorization: Bearer {TOKEN}
Content-Type: application/json

{
  "title": "Ø¹Ø±Ø¶ Ø®Ø§Øµ! ğŸ‰",
  "body": "Ø®ØµÙ… 50% Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ù…Ø¯Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©",
  "user_id": 42,
  "type": "promotion",
  "data": {
    "promo_code": "SAVE50",
    "expires_at": "2025-12-31"
  }
}
```

### Ù…Ø«Ø§Ù„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©

```json
{
  "message": "created",
  "data": {
    "id": 156,
    "user_id": 42,
    "title": "Ø¹Ø±Ø¶ Ø®Ø§Øµ! ğŸ‰",
    "body": "Ø®ØµÙ… 50% Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© Ù„Ù…Ø¯Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©",
    "type": "promotion",
    "data": {
      "promo_code": "SAVE50",
      "expires_at": "2025-12-31"
    },
    "read_at": null,
    "created_at": "2025-12-11T12:30:00.000000Z"
  },
  "external_sent": true
}
```

---

## 3ï¸âƒ£ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„

### ğŸ¯ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 1: Ø¥Ø±Ø³Ø§Ù„ Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯

```javascript
// Ø¥Ø±Ø³Ø§Ù„ Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯ Ø¨Ù€ ID = 42
await fetch('/api/notifications', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: 'Ø±Ø³Ø§Ù„Ø© Ø®Ø§ØµØ©',
    body: 'ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø¥Ø¹Ù„Ø§Ù†Ùƒ Ø¨Ù†Ø¬Ø§Ø­!',
    user_id: 42
  })
});
```

---

### ğŸ‘¥ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 2: Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¹Ø¯Ø© Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†

> **Ù…Ù„Ø§Ø­Ø¸Ø©**: Ø§Ù„Ù€ API Ø§Ù„Ø­Ø§Ù„ÙŠ ÙŠØ¯Ø¹Ù… Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ÙÙŠ ÙƒÙ„ Ø·Ù„Ø¨.
> Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¹Ø¯Ø© Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†ØŒ ÙŠØ¬Ø¨ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø·Ù„Ø¨ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù….

```javascript
// Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±ÙŠÙ†
const selectedUserIds = [42, 55, 78, 103];

// Ø¥Ø±Ø³Ø§Ù„ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…
for (const userId of selectedUserIds) {
  await fetch('/api/notifications', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      title: 'Ø¥Ø´Ø¹Ø§Ø± Ø¹Ø§Ù…',
      body: 'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù‡Ù†Ø§',
      user_id: userId
    })
  });
}
```

**ğŸ’¡ Ù†ØµÙŠØ­Ø©**: Ø§Ø³ØªØ®Ø¯Ù… `Promise.all` Ù„Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠ:

```javascript
const notifications = selectedUserIds.map(userId =>
  fetch('/api/notifications', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      title: 'Ø¥Ø´Ø¹Ø§Ø± Ø¹Ø§Ù…',
      body: 'Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±',
      user_id: userId
    })
  })
);

await Promise.all(notifications);
```

---

### ğŸŒ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ 3: Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†

**Ø§Ù„Ø®Ø·ÙˆØ§Øª:**

1. **Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†** (Ù…Ø¹ pagination)
2. **Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…**

```javascript
async function sendToAllUsers(title, body) {
  let page = 1;
  let hasMore = true;
  
  while (hasMore) {
    // Ø¬Ù„Ø¨ ØµÙØ­Ø© Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    const response = await fetch(
      `/api/admin/users-summary?per_page=100&page=${page}&role=user`,
      { headers: { 'Authorization': `Bearer ${token}` } }
    );
    const data = await response.json();
    
    // Ø¥Ø±Ø³Ø§Ù„ Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„ØµÙØ­Ø©
    const notifications = data.users.map(user =>
      fetch('/api/notifications', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          title,
          body,
          user_id: user.id
        })
      })
    );
    
    await Promise.all(notifications);
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØµÙØ­Ø§Øª Ø£Ø®Ø±Ù‰
    hasMore = page < data.meta.last_page;
    page++;
  }
}

// Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
await sendToAllUsers(
  'ØªØ­Ø¯ÙŠØ« Ù…Ù‡Ù…! ğŸ“¢',
  'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡Ø§.'
);
```

---

## ğŸ“‹ Ù…Ù„Ø®Øµ Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆØµÙˆÙ„ (Quick Reference)

| Ø§Ù„ØºØ±Ø¶ | Method | Endpoint |
|-------|--------|----------|
| Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† | `GET` | `/api/admin/users-summary` |
| Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± | `POST` | `/api/notifications` |

---

## âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

1. **Cooldown**: Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© Ù„Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù…Ø¯Ø© **Ø¯Ù‚ÙŠÙ‚ØªÙŠÙ†**
2. **Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©**: ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰:
   - Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… `enable_global_external_notif`
   - ØªÙØ¶ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… `receive_external_notif`
3. **Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª**: ÙÙ‚Ø· Ø§Ù„Ù€ Admin ÙŠÙ…ÙƒÙ†Ù‡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª

---

## ğŸ¨ Ø§Ù‚ØªØ±Ø§Ø­ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸ“¬ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: [________________________]                â”‚
â”‚                                                     â”‚
â”‚  Ø§Ù„Ù…Ø­ØªÙˆÙ‰:                                          â”‚
â”‚  [                                                 ]â”‚
â”‚  [                                                 ]â”‚
â”‚  [_________________________________________________]â”‚
â”‚                                                     â”‚
â”‚  Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙÙˆÙ†:                                       â”‚
â”‚  â—‹ Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ø­Ø¯     [ğŸ” Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…]              â”‚
â”‚  â—‹ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ø­Ø¯Ø¯ÙŠÙ† [ğŸ“‹ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©]          â”‚
â”‚  â—‹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†                                 â”‚
â”‚                                                     â”‚
â”‚              [Ø¥Ù„ØºØ§Ø¡]  [ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±]            â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 2025-12-11*
