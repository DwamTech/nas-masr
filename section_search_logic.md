# توثيق منطق البحث داخل الأقسام (Section Search Logic)

هذا الملف يشرح كيفية عمل البحث عند استعراض الإعلانات داخل قسم معين (Endpoint الخاص بالـ Listings).

## الرابط (Endpoint)
```
GET /api/v1/{section_slug}/listings
```

## الباراميترز (Query Parameters)
- `q`: (اختياري) كلمة البحث المراد الفلترة بها.

## التحديث الجديد في منطق البحث
سابقاً، كان البحث يعتمد فقط على **العنوان (Title)** و **الوصف (Description)**.
تم تحديث الـ Backend ليقوم البحث بكلمة `q` ليشمل جميع البيانات المرتبطة للإعلان، ليطابق سلوك البحث العام (Global Search).

عند إرسال `q=كلمة_بحث`، سيتم إرجاع الإعلانات التي تحتوي على "كلمة_بحث" في **أيٍ** من الحقول التالية:

1. **عنوان الإعلان (Title)**
   - يتم البحث مع مراعاة تطابق الأحرف (أ، إ، آ -> ا).
2. **وصف الإعلان (Description)**
3. **العنوان النصي (Address)**
4. **المحافظة (Governorate)**
   - البحث باسم المحافظة (مثلاً: "القاهرة").
5. **المدينة (City)**
   - البحث باسم المدينة (مثلاً: "مدينة نصر").
6. **الماركة (Make)**
   - (للأقسام التي تدعم الماركات مثل السيارات).
7. **الموديل (Model)**
   - (للأقسام التي تدعم الموديلات).
8. **القسم الرئيسي (Main Section)**
   - (إذا كان القسم يحتوي على أقسام رئيسية فرعية).
9. **القسم الفرعي (Sub Section)**
   - (إذا كان القسم يحتوي على أقسام فرعية).
10. **الخصائص الإضافية (Attributes)**
    - يتم البحث في قيم الخصائص (EAV) الخاصة بالإعلان (مثل "عدد الغرف"، "نوع الوقود"، إلخ).

## مثال للاستخدام
للبحث عن "بي ام دبليو" داخل قسم السيارات:

```http
GET /api/v1/cars/listings?q=بي ام دبليو
```
**النتيجة:** ستعود الإعلانات التي عنوانها أو وصفها يحتوي على "بي ام دبليو"، أو الماركة الخاصة بها هي "بي ام دبليو".

للبحث عن "القاهرة" داخل قسم العقارات:
```http
GET /api/v1/real-estate/listings?q=القاهرة
```
**النتيجة:** ستعود الإعلانات الموجودة في محافظة "القاهرة" أو التي تحتوي على الكلمة في العنوان/الوصف.
